# üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å .htaccess

## ‚ùå **–ï—Å–ª–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –æ—à–∏–±–∫–∞ 500:**

### **–®–∞–≥ 1 - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π .htaccess**
–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª `.htaccess` –±—ã–ª –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∏ —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–¥—É–ª–µ–π `<IfModule>` –¥–ª—è –≤—Å–µ—Ö –¥–∏—Ä–µ–∫—Ç–∏–≤
- ‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `Require all denied`
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ RewriteRule –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ PHP

### **–®–∞–≥ 2 - –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ 500 –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è**
–ó–∞–º–µ–Ω–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π `.htaccess` –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é:

```bash
# –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ —Ç–µ–∫—É—â–∏–π .htaccess
mv .htaccess .htaccess_backup

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é
mv .htaccess_minimal .htaccess
```

### **–®–∞–≥ 3 - –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**
–ï—Å–ª–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç, –¥–æ–±–∞–≤–ª—è–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã –ø–æ –æ–¥–Ω–æ–π –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏.

---

## üõ°Ô∏è **–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**

### **1. –ó–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
**–ë—ã–ª–æ:**
```apache
Header always set X-XSS-Protection "1; mode=block"
```

**–°—Ç–∞–ª–æ:**
```apache
<IfModule mod_headers.c>
    Header always set X-XSS-Protection "1; mode=block"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "SAMEORIGIN"
</IfModule>
```

### **2. PHP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**
**–ë—ã–ª–æ:**
```apache
php_value upload_max_filesize 5M
php_value post_max_size 5M
```

**–°—Ç–∞–ª–æ:**
```apache
<IfModule mod_php7.c>
    php_value upload_max_filesize 5M
    php_value post_max_size 5M
    php_value date.timezone "Europe/Kiev"
</IfModule>

<IfModule mod_php8.c>
    php_value upload_max_filesize 5M
    php_value post_max_size 5M
    php_value date.timezone "Europe/Kiev"
</IfModule>
```

### **3. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ PHP –≤ uploads**
**–ë—ã–ª–æ (–ø—Ä–æ–±–ª–µ–º–Ω–æ–µ):**
```apache
<Directory "assets/uploads">
    php_flag engine off
    Options -ExecCGI
    AddHandler cgi-script .php .pl .py .jsp .asp .sh .cgi
</Directory>
```

**–°—Ç–∞–ª–æ:**
```apache
RewriteCond %{REQUEST_URI} ^/assets/uploads/.*\.(php|phtml|php3|php4|php5|pl|py|jsp|asp|sh|cgi)$ [NC]
RewriteRule ^.*$ - [F,L]
```

### **4. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–æ—Å—Ç—É–ø–∞**
**–ë—ã–ª–æ:**
```apache
<FilesMatch "\.(ini|log|sh|sql|conf)$">
    Order allow,deny
    Deny from all
</FilesMatch>
```

**–°—Ç–∞–ª–æ:**
```apache
<FilesMatch "\.(ini|log|sh|sql|conf|bak|backup)$">
    Require all denied
</FilesMatch>
```

---

## üîí **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ uploads/**

–°–æ–∑–¥–∞–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª `assets/uploads/.htaccess`:
- üö´ –ë–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å–µ PHP —Ñ–∞–π–ª—ã
- ‚úÖ –†–∞–∑—Ä–µ—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–∏–ø—ã —Ñ–∞–π–ª–æ–≤
- üõ°Ô∏è –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ MIME —Ç–∏–ø—ã
- üìµ –û—Ç–∫–ª—é—á–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤

---

## üîç **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º:**

### **–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ 500 –≤—Å–µ –µ—â–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è:**

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Apache:**
   ```bash
   tail -f /var/log/apache2/error.log
   ```

2. **–í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ .htaccess:**
   ```bash
   mv .htaccess .htaccess_disabled
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–∫–∏–µ –º–æ–¥—É–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã:**
   - `mod_rewrite` - –¥–ª—è –∫—Ä–∞—Å–∏–≤—ã—Ö URL
   - `mod_headers` - –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - `mod_expires` - –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
   - `mod_deflate` - –¥–ª—è —Å–∂–∞—Ç–∏—è

4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é:**
   –§–∞–π–ª `.htaccess_minimal` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Å–∞–º—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã.

---

## üéØ **–ß—Ç–æ —Ç–æ—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

### **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –≤–∫–ª—é—á–∞–µ—Ç:**
- ‚úÖ RewriteEngine On
- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–µ URL –¥–ª—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ config/ –∏ includes/
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ PHP –≤ uploads/
- ‚úÖ –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –ø–∞–ø–æ–∫
- ‚úÖ UTF-8 –∫–æ–¥–∏—Ä–æ–≤–∫–∞
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ 404

### **–≠—Ç–∏ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã –±–µ–∑–æ–ø–∞—Å–Ω—ã –Ω–∞ 99% —Ö–æ—Å—Ç–∏–Ω–≥–æ–≤.**

---

## üìã **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–º–µ–Ω–µ:**

### **–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è:**
```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
cp .htaccess .htaccess_full_backup

# 2. –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é
cp .htaccess_minimal .htaccess

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∞–π—Ç
# –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç - –æ—Ç–ª–∏—á–Ω–æ!
# –ï—Å–ª–∏ –Ω–µ—Ç - –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ .htaccess
```

### **–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–ª–Ω—É—é –≤–µ—Ä—Å–∏—é:**
```bash
# –í–µ—Ä–Ω–∏—Ç–µ –ø–æ–ª–Ω—É—é –≤–µ—Ä—Å–∏—é
cp .htaccess_full_backup .htaccess
```

---

## ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

- üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞** - –≤—Å–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- üöÄ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∞** - –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–¥—É–ª–µ–π
- üì± **URL —Ä–∞–±–æ—Ç–∞—é—Ç** - –∫—Ä–∞—Å–∏–≤—ã–µ —Å—Å—ã–ª–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç
- üîß **–õ–µ–≥–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** - –µ—Å—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–°–∞–π—Ç –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫ 500!** üéâ