# –ó–≤—ñ—Ç: –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ "Unknown column 'user_type'"

## üö® –ü—Ä–æ–±–ª–µ–º–∞
–Ü–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä –≤–∏–¥–∞–≤–∞–≤ –ø–æ–º–∏–ª–∫—É: **"Unknown column 'user_type' in 'field list'"** –ø—Ä–∏ —Å–ø—Ä–æ–±—ñ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

## üîç –ü—Ä–∏—á–∏–Ω–∞
–í –∫–æ–¥—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–æ—Å—è –ø–æ–ª–µ `user_type`, –∞–ª–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ —Ç–∞–±–ª–∏—Ü—ñ `users` –≤ `database.sql` –≤–æ–Ω–æ –±—É–ª–æ –≤—ñ–¥—Å—É—Ç–Ω—î.

## ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

### 1. –û–Ω–æ–≤–ª–µ–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ñ `users` –≤ `install/database.sql`

#### –î–æ–¥–∞–Ω–æ –ø–æ–ª—è:
```sql
`user_type` enum('user','admin','moderator','partner') DEFAULT 'user',
`group_id` int(11) DEFAULT NULL,
```

#### –î–æ–¥–∞–Ω–æ —ñ–Ω–¥–µ–∫—Å–∏:
```sql
KEY `idx_user_type` (`user_type`),
KEY `idx_group_id` (`group_id`),
FOREIGN KEY (`group_id`) REFERENCES `user_groups`(`id`) ON DELETE SET NULL
```

### 2. –û–Ω–æ–≤–ª–µ–Ω–æ –ª–æ–≥—ñ–∫—É —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

#### –í `install/steps/step_8.php`:
```sql
INSERT INTO users (username, first_name, last_name, email, password, role, user_type, group_id, status, email_verified, created_at) 
VALUES (?, ?, ?, ?, ?, 'admin', 'admin', 1, 'active', 1, NOW())
```

#### –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –æ—Ç—Ä–∏–º—É—î:
- **`role`**: 'admin' - –æ—Å–Ω–æ–≤–Ω–∞ —Ä–æ–ª—å
- **`user_type`**: 'admin' - —Ç–∏–ø –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞  
- **`group_id`**: 1 - –≥—Ä—É–ø–∞ "–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏" –∑ –ø–æ–≤–Ω–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏
- **`status`**: 'active' - –∞–∫—Ç–∏–≤–Ω–∏–π —Å—Ç–∞—Ç—É—Å
- **`email_verified`**: 1 - –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏–π email

### 3. –î–æ–¥–∞–Ω–æ –≥—Ä—É–ø–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –≤ `install/initial_data.sql`

```sql
INSERT IGNORE INTO `user_groups` (`name`, `description`, `permissions`, `color`, `sort_order`) VALUES
('–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏', '–ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –≤—Å—ñ—Ö —Ñ—É–Ω–∫—Ü—ñ–π —Å–∏—Å—Ç–µ–º–∏', 
 '["admin.full_access","users.manage","ads.manage","settings.manage","groups.manage","categories.manage","locations.manage","payments.manage","stats.view","logs.view","backups.manage"]', 
 '#dc3545', 1),
('–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä–∏', '–ú–æ–¥–µ—Ä–∞—Ü—ñ—è –∫–æ–Ω—Ç–µ–Ω—Ç—É —Ç–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤', 
 '["ads.moderate","users.moderate","comments.moderate","reports.view","stats.view"]', 
 '#fd7e14', 2),
('–ü–∞—Ä—Ç–Ω–µ—Ä–∏', '–†–æ–∑—à–∏—Ä–µ–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è –±—ñ–∑–Ω–µ—Å-–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤', 
 '["ads.create_unlimited","ads.featured","stats.own","analytics.basic"]', 
 '#6f42c1', 3),
('–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ', '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —Å–∏—Å—Ç–µ–º–∏', 
 '["ads.create","ads.edit_own","ads.delete_own","profile.edit","messages.send"]', 
 '#28a745', 4),
('VIP –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ', '–ü—Ä–µ–º—ñ—É–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º–∏ –º–æ–∂–ª–∏–≤–æ—Å—Ç—è–º–∏', 
 '["ads.create_unlimited","ads.priority","ads.featured_discount","support.priority"]', 
 '#ffc107', 5);
```

## üõ°Ô∏è –ü—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –ì—Ä—É–ø–∞ "–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏" (ID: 1) –º–∞—î –ø—Ä–∞–≤–∞:
- **admin.full_access** - –ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ
- **users.manage** - —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏
- **ads.manage** - —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è–º–∏
- **settings.manage** - –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏
- **groups.manage** - —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≥—Ä—É–ø–∞–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- **categories.manage** - —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏
- **locations.manage** - —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ª–æ–∫–∞—Ü—ñ—è–º–∏
- **payments.manage** - —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–ª–∞—Ç–µ–∂–∞–º–∏
- **stats.view** - –ø–µ—Ä–µ–≥–ª—è–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- **logs.view** - –ø–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤
- **backups.manage** - —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–µ–∑–µ—Ä–≤–Ω–∏–º–∏ –∫–æ–ø—ñ—è–º–∏

## üîß –õ–æ–≥—ñ–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –ö—Ä–æ–∫–∏ —ñ–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä–∞:
1. **–í–∏–¥–∞–ª–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–∏—Ö –∞–¥–º—ñ–Ω—ñ–≤**: `DELETE FROM users WHERE role = 'admin' OR user_type = 'admin'`
2. **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞** –∑:
   - –£–Ω—ñ–∫–∞–ª—å–Ω–∏–º username —Ç–∞ email
   - –ó–∞—Ö–µ—à–æ–≤–∞–Ω–∏–º –ø–∞—Ä–æ–ª–µ–º
   - –†–æ–ª–ª—é —Ç–∞ —Ç–∏–ø–æ–º 'admin'
   - –ì—Ä—É–ø–æ—é –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤ (ID: 1)
   - –ê–∫—Ç–∏–≤–Ω–∏–º —Å—Ç–∞—Ç—É—Å–æ–º
   - –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏–º email

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –≤ —Ç–∞–±–ª–∏—Ü—ñ `users`
- ‚úÖ –û—Ç—Ä–∏–º—É—î –ø–æ–≤–Ω—ñ –ø—Ä–∞–≤–∞ —á–µ—Ä–µ–∑ –≥—Ä—É–ø—É
- ‚úÖ –ú–æ–∂–µ –≤—Ö–æ–¥–∏—Ç–∏ —á–µ—Ä–µ–∑ `admin/index.php`
- ‚úÖ –ú–∞—î –¥–æ—Å—Ç—É–ø –¥–æ –≤—Å—ñ—Ö —Ñ—É–Ω–∫—Ü—ñ–π –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –°—Ç–≤–æ—Ä–µ–Ω–æ `test_admin_creation.php` –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏ —Ç–∞–±–ª–∏—Ü—ñ `users`
- ‚úÖ –ù–∞—è–≤–Ω–æ—Å—Ç—ñ –≥—Ä—É–ø –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- ‚úÖ –Ü—Å–Ω—É—é—á–∏—Ö –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –¢–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ:
- **Username**: testadmin
- **Email**: admin@test.com
- **Password**: admin123
- **Role**: admin
- **User Type**: admin
- **Group ID**: 1 (–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏)

## üìã –ó–º—ñ–Ω–∏ –≤ —Ñ–∞–π–ª–∞—Ö

### –ó–º—ñ–Ω–µ–Ω–æ:
- ‚úÖ `install/database.sql` - –¥–æ–¥–∞–Ω–æ –ø–æ–ª—è `user_type` —Ç–∞ `group_id`
- ‚úÖ `install/initial_data.sql` - –¥–æ–¥–∞–Ω–æ –≥—Ä—É–ø–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- ‚úÖ `install/steps/step_8.php` - –æ–Ω–æ–≤–ª–µ–Ω–æ –∑–∞–ø–∏—Ç —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞–¥–º—ñ–Ω–∞
- ‚úÖ `.gitignore` - –¥–æ–¥–∞–Ω–æ —ñ–≥–Ω–æ—Ä—É–≤–∞–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤

### –°—Ç–≤–æ—Ä–µ–Ω–æ:
- ‚úÖ `test_admin_creation.php` - —Ç–µ—Å—Ç–æ–≤–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ (–Ω–µ –≤ Git)

### –ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ:
- ‚úÖ `core/functions.php` - —Ñ—É–Ω–∫—Ü—ñ—ó –ø—Ä–∞—Ü—é—é—Ç—å –∑ `user_type`
- ‚úÖ `admin/index.php` - –≤—Ö—ñ–¥ –ø—Ä–∞—Ü—é—î –∑ —Ä–æ–ª–ª—é `admin`
- ‚úÖ `install/ajax_step8.php` - –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –ü—Ä–æ–±–ª–µ–º–∞ –≤–∏—Ä—ñ—à–µ–Ω–∞:
- ‚ùå **–†–∞–Ω—ñ—à–µ**: "Unknown column 'user_type'" - —ñ–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä –Ω–µ –ø—Ä–∞—Ü—é–≤–∞–≤
- ‚úÖ **–¢–µ–ø–µ—Ä**: –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –±–µ–∑ –ø–æ–º–∏–ª–æ–∫

### –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤:
- üîê **–ü–æ–¥–≤—ñ–π–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞**: role='admin' AND user_type='admin'
- üë• **–ì—Ä—É–ø–æ–≤—ñ –ø—Ä–∞–≤–∞**: —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—é user_groups
- üõ°Ô∏è **–ì–Ω—É—á–∫—ñ—Å—Ç—å**: –º–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ —Ç–∏–ø–∏ –∞–¥–º—ñ–Ω—ñ–≤

### –ì–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å –¥–æ production:
- ‚úÖ **–°—Ç–∞–±—ñ–ª—å–Ω–∏–π —ñ–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä** –±–µ–∑ –ø–æ–º–∏–ª–æ–∫ SQL
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ñ –ø—Ä–∞–≤–∞** –¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞** –≥—Ä—É–ø –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- ‚úÖ **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è** —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–Ü–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä —Ç–µ–ø–µ—Ä –ø—Ä–∞—Ü—é—î –∫–æ—Ä–µ–∫—Ç–Ω–æ —ñ —Å—Ç–≤–æ—Ä—é—î –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∑ –ø–æ–≤–Ω–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏! üöÄ**