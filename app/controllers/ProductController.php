<?php namespace App\Controllers; use App\Models\Product; class ProductController { public function index($db) { $products = Product::findAll($db); require_once __DIR__ . "/../views/products/index.php"; } public function filter($db) { $game = $_GET["game"] ?? ""; $type = $_GET["type"] ?? ""; $sql = "SELECT p.*, u.login as seller_name FROM products p JOIN users u ON p.user_id = u.id WHERE p.status = \"active\""; $params = []; if ($game) { $sql .= " AND p.game = ?"; $params[] = $game; } if ($type) { $sql .= " AND p.type = ?"; $params[] = $type; } $stmt = $db->prepare($sql); $stmt->execute($params); $products = $stmt->fetchAll(\PDO::FETCH_ASSOC); echo json_encode($products); } }
